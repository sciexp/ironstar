---
id: UserPreferencesService
name: User Preferences Service
version: 0.0.1
summary: |
  Manages user-specific UI settings: theme, default catalog, and arbitrary UI state.
owners:
  - engineering
sends: []
receives: []
---

## Responsibilities

- Initialize preferences for new users
- Set theme (Light, Dark, System)
- Configure default catalog for queries
- Store arbitrary UI state as JSON blob

## Aggregate: UserPreferences

One aggregate per authenticated user (keyed by user_id).

### Key Value Objects

- **PreferencesId**: Typically matches UserId
- **Theme**: Light | Dark | System (enum)
- **CatalogName**: Default catalog for DuckDB queries

### Invariants

- UI state must be valid JSON (enforced at boundary)
- Default catalog must be valid (runtime validation by DuckDB)

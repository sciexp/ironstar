---
id: UserPreferencesService
name: User Preferences Service
version: 0.0.1
summary: |
  Manages user-scoped settings (theme, locale, UI state) that apply globally across all workspaces.
owners:
  - engineering
sends:
  - id: UserPreferencesInitialized
    version: 0.0.1
  - id: UserPreferencesThemeSet
    version: 0.0.1
  - id: UserPreferencesLocaleSet
    version: 0.0.1
  - id: UserPreferencesUiStateUpdated
    version: 0.0.1
receives:
  - id: InitializePreferences
    version: 0.0.1
  - id: SetTheme
    version: 0.0.1
  - id: SetLocale
    version: 0.0.1
  - id: UpdateUiState
    version: 0.0.1
---

## Responsibilities

- Initialize preferences for new users
- Set theme (Light, Dark, System)
- Set locale for internationalization
- Store arbitrary UI state as JSON blob

See WorkspacePreferencesService for workspace-scoped settings such as default catalog selection.

## Aggregate: UserPreferences

One aggregate per authenticated user (keyed by user_id).

### Key Value Objects

- **PreferencesId**: Typically matches UserId
- **Theme**: Light | Dark | System (enum)
- **Locale**: User's preferred locale string (e.g., en-US)

### Invariants

- UI state must be valid JSON (enforced at boundary)
- Settings apply globally across all workspaces
